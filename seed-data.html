<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Seed TruckerCan Database</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2ecc71;
        }
        button {
            background: #2ecc71;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #27ae60;
        }
        .clear-btn {
            background: #e74c3c;
        }
        .clear-btn:hover {
            background: #c0392b;
        }
        #status {
            margin-top: 20px;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 5px;
            min-height: 100px;
        }
        .success {
            color: #2ecc71;
        }
        .error {
            color: #e74c3c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöö TruckerCan Database Seeder</h1>
        <p>Click the button below to add sample bathrooms to your Firebase database.</p>

        <button onclick="seedDatabase()">Add Sample Bathrooms</button>
        <button class="clear-btn" onclick="clearDatabase()">Clear All Bathrooms</button>

        <div id="status"></div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, Timestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAhCXWT8Fj2E6zT6HNloK7JNYOV1E4pdUg",
            authDomain: "truckcan-3a583.firebaseapp.com",
            projectId: "truckcan-3a583",
            storageBucket: "truckcan-3a583.firebasestorage.app",
            messagingSenderId: "403434775821",
            appId: "1:403434775821:web:a0efe1b0982fae8dd0bc44",
            measurementId: "G-ELY5NM61NX"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.db = db;
        window.firestoreModules = { collection, addDoc, getDocs, deleteDoc, doc, Timestamp };

        console.log('Firebase initialized!');
    </script>

    <script>
        const sampleBathrooms = [
            // Interstate 87 - New York
            {
                name: "Pilot Travel Center",
                lat: 41.7003,
                lon: -73.9210,
                highway: "I-87",
                exit: "15",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 2,
                tips: "Park in back row for quiet night"
            },
            {
                name: "TA Express",
                lat: 42.6526,
                lon: -73.7562,
                highway: "I-87",
                exit: "23",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 1,
                tips: "Great diner inside, clean showers"
            },
            // Interstate 95 - East Coast
            {
                name: "Loves Travel Stop",
                lat: 39.7392,
                lon: -75.5398,
                highway: "I-95",
                exit: "109",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 3,
                tips: "Busy during rush hour, arrive early for parking"
            },
            {
                name: "Flying J",
                lat: 35.8801,
                lon: -78.7880,
                highway: "I-95",
                exit: "98",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 2,
                tips: "Best BBQ in the area, friendly staff"
            },
            // Interstate 80 - Cross Country
            {
                name: "Petro Stopping Center",
                lat: 41.5868,
                lon: -93.6250,
                highway: "I-80",
                exit: "142",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 1,
                tips: "Huge lot, never full. Iron Skillet restaurant"
            },
            {
                name: "Sapp Bros",
                lat: 41.2565,
                lon: -96.0141,
                highway: "I-80",
                exit: "432",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 1,
                tips: "Casino next door, apple pie is amazing"
            },
            // Interstate 10 - Southern Route
            {
                name: "Buc-ee's",
                lat: 29.7604,
                lon: -95.3698,
                highway: "I-10",
                exit: "766",
                truckParking: false,
                open24h: true,
                parkingDifficulty: 4,
                tips: "No semi parking, but clean bathrooms. RV parking only"
            },
            {
                name: "Pilot Flying J",
                lat: 30.4515,
                lon: -91.1871,
                highway: "I-10",
                exit: "151",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 2,
                tips: "Good Cajun food, secure parking"
            },
            // Interstate 40 - Cross Country
            {
                name: "Loves Travel Stop",
                lat: 35.2220,
                lon: -101.8313,
                highway: "I-40",
                exit: "75",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 1,
                tips: "Middle of nowhere but great service"
            },
            {
                name: "TA Truck Stop",
                lat: 35.4676,
                lon: -97.5164,
                highway: "I-40",
                exit: "140",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 2,
                tips: "Full service shop, good for repairs"
            },
            // Rest Areas
            {
                name: "Welcome Center - Florida",
                lat: 30.4397,
                lon: -87.3286,
                highway: "I-10",
                exit: "Mile 5",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 1,
                tips: "Free OJ! Clean facilities, safe overnight"
            },
            {
                name: "Blue Ridge Rest Area",
                lat: 36.6085,
                lon: -81.5124,
                highway: "I-77",
                exit: "Mile 8",
                truckParking: true,
                open24h: true,
                parkingDifficulty: 1,
                tips: "Beautiful mountain views, quiet at night"
            }
        ];

        async function seedDatabase() {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = '<p>Adding bathrooms to database...</p>';

            try {
                const { collection, addDoc, Timestamp } = window.firestoreModules;
                const bathroomsRef = collection(window.db, 'bathrooms');

                let added = 0;
                for (const bathroom of sampleBathrooms) {
                    const bathroomData = {
                        ...bathroom,
                        createdAt: Timestamp.now(),
                        upvotes: Math.floor(Math.random() * 50),
                        downvotes: Math.floor(Math.random() * 10)
                    };

                    await addDoc(bathroomsRef, bathroomData);
                    added++;
                    statusDiv.innerHTML = `<p class="success">Added ${added} of ${sampleBathrooms.length} bathrooms...</p>`;
                }

                statusDiv.innerHTML = `
                    <p class="success">‚úÖ Success! Added ${added} bathrooms to your database.</p>
                    <p>Go to <a href="index.html" target="_blank">TruckerCan</a> to see them!</p>
                `;
            } catch (error) {
                statusDiv.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
                console.error('Error seeding database:', error);
            }
        }

        async function clearDatabase() {
            if (!confirm('Are you sure you want to delete ALL bathrooms from the database?')) {
                return;
            }

            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = '<p>Clearing database...</p>';

            try {
                const { collection, getDocs, deleteDoc, doc } = window.firestoreModules;
                const bathroomsRef = collection(window.db, 'bathrooms');
                const snapshot = await getDocs(bathroomsRef);

                let deleted = 0;
                for (const docSnapshot of snapshot.docs) {
                    await deleteDoc(doc(window.db, 'bathrooms', docSnapshot.id));
                    deleted++;
                    statusDiv.innerHTML = `<p>Deleted ${deleted} of ${snapshot.size} bathrooms...</p>`;
                }

                statusDiv.innerHTML = `<p class="success">‚úÖ Database cleared! Deleted ${deleted} bathrooms.</p>`;
            } catch (error) {
                statusDiv.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
                console.error('Error clearing database:', error);
            }
        }
    </script>
</body>
</html>
